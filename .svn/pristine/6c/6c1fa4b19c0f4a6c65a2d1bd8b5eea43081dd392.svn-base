<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">
          <h1>
            <?php echo $titleHeader; ?>
            <small>
			<?php echo $descHeader ?>
			</small>
          </h1>
          <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i> Inicio</a></li>
            <li class="active"></li>
          </ol>
        </section>
      
        
		<div id="toolbar">
            <div class="form-inline" role="form">
                                <div class="form-group"><button id="btn_eliminar" class="btn btn-default">Eliminar</button></div>
                <div class="form-group">
                    <span>Limit: </span>
                    <input name="limit" class="form-control w70" type="number" value="20">
                </div>
                <div class="form-group">
                    <input name="search" class="form-control" type="text" id="search" placeholder="Buscar">
                </div>
                <button id="ok" type="submit" class="btn btn-default">OK</button>
            </div>
        </div>
  
  						
        <!-- Main content -->
        <section class="content">
        <table id="tabladetallemovimientos"
			data-show-footer="false"
               data-show-columns="true"
               data-show-refresh="true"
			   data-show-export="true"
			   data-show-pagination-switch="false"	 			   
			   data-onlyInfoPagination="true"
			   data-page-list="[20, 50, 100, 200]" 
			   data-pagination="true"
               data-side-pagination="server"
			   data-toggle="table"
			   data-query-params="queryParams"
			   data-toolbar="#toolbar"
			   data-method="post"
			   data-response-handler="responseHandler"
					   data-url="<?php echo base_url(); ?>Cuenta/obtenerdetallemovimientos">
					<thead>
					<tr>
						 <th data-checkbox="true">-</th>
						 <th data-field="id_transaccion"  data-sortable="true" >Id.</th>
						 <th data-field="id_cuenta" data-filterby="true">Nro. Cuenta</th>
						 <th data-field="nombre_cuenta"  data-sortable="true" data-align="left">Nombre Cta.</th>
						 <th data-field="nro_pedido"  data-sortable="true" data-align="left"  data-formatter="f_idpedido">Pedido</th>
						 <th data-field="glosa"  data-sortable="true" data-align="left">Obs.</th>
						 <th data-field="fecha_ingreso" data-sortable="true" >Fecha</th>
						 <th data-field="debe" data-sortable="true" data-formatter="PriceFormatter"  data-align="right" >Monto Abono.</th>
						 <th data-field="haber" data-sortable="true" data-formatter="PriceFormatter" data-align="right" >Monto Cargo</th>
					</tr>
					</thead>
					</table>
        </section><!-- /.content -->
</div><!-- /.content-wrapper -->
<script type="text/javascript">

$(document).ready(function() {
	var $idpedido = <?php echo $idpedido; ?> ;
	var $table = $('#tabladetallemovimientos');
    var $ok = $('#ok');  
    var $search = $('#search');

	if($idpedido!=-1){
		$search.val($idpedido);
		$table.bootstrapTable('refresh');
	}
	$ok.click(function () {$table.bootstrapTable('refresh');});
	$('#btn_eliminar').click(function () {

		if(confirm('Â¿ Seguro desea eliminar la transaccion ? '))
		{
		var data = $('#tabladetallemovimientos').bootstrapTable('getSelections');
		var ids = $.map(data, function (item) {
			eliminaTransaccion(item['id_transaccion']);
		});
		$table.bootstrapTable('refresh');
		}
	});

	
});	

function eliminaTransaccion(id)
{
	
		jQuery.ajax({
				method: "POST",
					url: "<?php echo base_url(); ?>Cuenta/eliminaTransaccion/",
					data:{id},
					dataType: 'json'

		});		
	//}
}
function i_prod(data)
{
	return[
			'<a href="<?php echo base_url(); ?>Productos/agregar/',
			data,
			'">',
			data,
			'</a>'
		   	].join('');
}

/**
 * Procesa la respuesta del metodo que carga vía ajax los datos a la tabla.
 */
function responseHandler(res){
//	calculaTotalesListado(res);
	return res;
}
function f_idpedido(data)
{
	return[
			'<a href="<?php echo base_url(); ?>Pedido/nuevoPedido/',
			data,
			'">',
			data,
			'</a>'
		   	].join('');

}
/**
 * Funcion que setea los parametros.
 */
function queryParams(params) {
	
    $('#toolbar').find('input[name]').each(function () {
        params[$(this).attr('name')] = $(this).val();
    });
    
    return params;
}		
</script>