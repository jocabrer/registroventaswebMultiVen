ALTER VIEW v_cabecera AS
/*
  Muestra una cabacera de pedido, datos del cliente y su estado 
*/
SELECT
  `cab`.`id`            AS `id`,
  `est`.secuencia       AS `est_esecuencia`,
  `est`.descripcion     AS `est_desc`,
  `ce`.`fecha`          AS `est_fec_estactual`,
  `cab`.`fecha_ingreso` AS `est_fec_ing`,
  DATEDIFF(NOW(),`cab`.`fecha_ingreso`) diastranscurridos,
  `cli`.`id`            AS `cli_id`,
  `cli`.`nombre`        AS `cli_nom`,
  `cab`.`conFactura`    AS `ConFactura`,
  `cab`.`comision`    AS `comision`
FROM 
     `cabecera` `cab`
     INNER JOIN `cambioestado` `ce` ON `cab`.`estadoActual` = `ce`.`id` AND `cab`.`id` = `ce`.`id_cabecera`
     INNER JOIN `estado` `est`      ON `ce`.`estado` = `est`.`secuencia`
     INNER JOIN `cliente` `cli`     ON `cab`.`id_cliente` = `cli`.`id`
