<?php

class M_Productos extends CI_Model {
	
    function __construct()
    {
        // Call the Model constructor
        parent::__construct();
		
    }
	
    function getProdPorid($idProd)
    {
    	$this->db->select('*');
    	$this->db->from('producto');
    	$this->db->where('id',$idProd);
    	 
    	$query = $this->db->get();
    	 
    	return $query->result_array();
    }
	/**
	 * 
	 *  Metodo de busqueda por COD
	 */
	function get_productos($search,$limit,$ordenarpor,$orden)
	{
		return
		$this->db->select('*, (producto.valor_venta- producto.costo) as ganancia')->from('producto')
		->group_start()
		->or_like(' codigo ', $search)
		->or_like(' descripcion', $search)
		->group_end()
		
		->limit($limit)
		->order_by($ordenarpor, $orden)
		->get()->result_array();
	}
    /**
     * Metodo de busqueda por descripcion 
     * 
     * @param unknown $criterio
     */
    function getAll($criterio)
    {
        $sql = "SELECT id, nombre FROM producto WHERE descripcion LIKE  '%".$criterio."%'";
        $query = $this->db->query($sql);
        return $query->result_array();
    }
    
     /**
      * Obtiene un producto por su ID.
      */
     function getById($idprod)
     {
     	
     	$sql = "SELECT * FROM producto WHERE id = " . $idprod;
     	$query = $this->db->query($sql);
     	return $query->result_array();
     	
     }
    
	/*
	* Elimina un producto de la >BD.
	*/    
     function delete_prod($id)
     {
     	return $this->db->simple_query("DELETE FROM `producto` WHERE `id` = ".$id);
     }
     
     
	/**
	 * 
	 * @param unknown $codigo
	 * @param unknown $nombre
	 * @param unknown $Descripcion
	 * @param unknown $valor_venta
	 * @param unknown $costo
	 */
    function insert_entry($codigo,$Nombre,$Descripcion, $valor_venta, $costo)
    {
    	$this->codigo   	  = $codigo;
    	$this->nombre   	  = $Nombre;
    	$this->Descripcion    = $Descripcion;
    	$this->valor_venta    = $valor_venta;
    	$this->costo 		  = $costo;
    	
    	$this->db->insert('producto', $this);
    	
    	$insert_id = $this->db->insert_id();
    	
    	return  $insert_id;
    }
 	
    function ajax_getProductos($cod_prod)
    {
    	
    	
    }
    
    
    function update_entry($idproducto,$codigo,$Nombre,$Descripcion, $valor_venta, $costo)
    {
    	$this->codigo   	  = $codigo;
    	$this->Nombre   	  = $Nombre;
    	$this->Descripcion    = $Descripcion;
    	$this->valor_venta    = $valor_venta;
    	$this->costo 		  = $costo;
    	
    	$this->db->where('id', $idproducto);
    	$this->db->update('producto', $this);
    }
    

}

?>