
<?php
defined('BASEPATH') or exit('No direct script access allowed');

/*
 * Controlar de Seguimientos
 */
class Seguimiento extends CI_Controller
{

    public function Index()
    {
        $dataContent['titleHeader']  =  "Sistema de seguimiento de pedidos ONLINE.";
        $dataContent['descHeader']   =  "ver estado de su pedido";
        
        $this->load->templatepublic('v_seguimiento_consulta', $dataContent);
    }
    
    
    public function Ver($idpedido=-1,$idcliente = -1)
    {
        $dataContent['titleHeader']  =  "Sistema de seguimiento de pedidos ONLINE.";
        $dataContent['descHeader']   =  "ver estado de su pedido";
        $dataContent['id_cabecera']   =  $idpedido;
        $dataContent['cliente']   =  $this->M_cliente->getcliente($idcliente)[0];
        //Autenticación
        
        $dataContent['datos_seguimiento'] = $this->ProcesaListado($this->M_pedido->get_SeguimientoPedido($idpedido,$idcliente));
        
        
        
        
        //var_dump( $dataContent['datos_seguimiento']);
        $this->load->templatepublic('v_seguimiento', $dataContent);
    }
    
    
    function ProcesaListado($data)
    {
        $this->load->library("Comun");
        
        for ($i = 0; $i < count($data); $i ++) {
            
            $fecha_mod =  $this->comun->transformaStringFecha($data[$i]["fecha_mod"]);
            $fecha_mod_hora = $this->comun->transformaStringFechaHora($data[$i]["fecha_mod"]);
            
            $data[$i]["fecha_mod"] = $fecha_mod->format('Y-m-d');
            $data[$i]["fecha_mod_hora"] = $fecha_mod_hora;
            $data[$i]["cuentadias_fecha_mod"] =  $this->comun->cuentaDias($fecha_mod, date_create());
        }
        
        return $data;
    }
}
