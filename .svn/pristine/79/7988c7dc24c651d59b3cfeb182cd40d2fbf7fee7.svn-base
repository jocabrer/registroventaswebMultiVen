<?php


class M_estados extends CI_Model {

  
	
	
    function __construct()
    {
        // Call the Model constructor
        parent::__construct();
		
    }
    function get_Estados()
    {
    	$query = $this->db->query("SELECT * FROM estado;");
    	return $query->result_array();
    }
    
    
    
    
    
	/***
	*	Graba en la tabla cambioestado un nuevo estado asignado a un pedido.
	*/
    function insert_entry($id_cabecera,$estado,$fecha,$idusuario)
    {
    
        $this->id_cabecera  = $id_cabecera;
        $this->estado 		= $estado;
        $this->id_usuario  = $idusuario;
        
        
	    $this->fecha        = $fecha->format('Y-m-d H:i:s');//$fecha;
        //$this->comentario   = $comentario;
		
        $this->db->insert('cambioestado', $this);
		
		// El id del nuevo estado.
        $insert_id = $this->db->insert_id();
        
        return  $insert_id;
    }
    
    
}



?>